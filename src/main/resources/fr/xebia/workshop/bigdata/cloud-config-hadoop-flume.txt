#cloud-config

runcmd:
 - [sh, -xc, "echo $(date) ': cloudinit runcmd begin'"]

# Stop hadoop
 - [sh, -xc, "for service in /etc/init.d/hadoop-*; do sudo $service stop; done"]

# Set hostname
 - [sh, -xc, "hostname $hostname"]

# Replace namenode host and jobtracker host
 - [sed 's/%%NAMENODE_HOST%%/$namenode/g' /etc/hadoop/conf/core-site.xml.template > /etc/hadoop/conf/core-site.xml"]
 - [sed 's/%%NAMENODE_HOST%%/$namenode/g' /etc/hadoop/conf/hdfs-site.xml.template > /etc/hadoop/conf/hdfs-site.xml"]

# start hadoop
 - [sh, -xc, "for service in /etc/init.d/hadoop-*; do sudo $service start; done"]